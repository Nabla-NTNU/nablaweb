{% extends "base.html" %}

{% block main %}
<style>
 #dash {
     display: grid;
     grid-template-columns: 1fr 1fr;
     grid-template-areas:
         "penalty user_events"
         "event_list event_list";
     justify-items: stretch;
     grid-column-gap: 40px;
     grid-row-gap: 20px;
 }

 @media (max-width: 600px) {
     #dash {
         grid-template-columns: 1fr;
         grid-template-areas:
             "penalty"
             "user_events"
             "event_list";
     }
 }

 #penalties {
     grid-area: penalty;
     align-self: end;
 }
 #user_events {
     grid-area: user_events;
 }

 #penalties, #user_events {
     padding-bottom: 7px;
     border-bottom: 1px solid black;
 }

 .header_like {
     font-size: 1.4em;
     line-height: 1.3em;
 }

 #event_list {
     grid-area: event_list;
 }

 .event_list__event .header_like {
     line-height: 2em;
 }

 .event_list__event__meta {
     display: inline-block;
     /*         float: right;*/
     margin-right: 12px;
 }

 .month__name {
     color: #507eff;
     border-bottom: 1px solid #507eff;
 }

 .penalties__questionmark {
     display: inline-block;
     border: 2px solid rgba(0,0,0,0.5);
     width: 20px;
     height: 20px;
     border-radius: 10px;
     text-align: center;
     line-height: 20px;
     color: rgba(0,0,0,0.5);
     font-weight: bold;
 }

 .penalties__list {
     position: absolute;
     background: white;
     border: 0.4px solid black;
     box-shadow: 1px 1px 4px rgba(0, 0, 0, 0.3);
     padding: 5px 10px;
     display: none;
 }

 .penalties__list__item {
     text-align: right;
 }

 .penalties__questionmark:hover ~ .penalties__list, .penalties__list:hover {
     display: block;
 }

 #dash a{
     text-decoration: none;
     color: inherit;
 }

 .user_events__item--empty {
     display: inline-block; /* Make the 'no events' text appear on same line */
 }

 .day {
     position: relative;
     padding: 4px 8px;
     padding-right: 53px; /* Compensate for day box */
     margin-bottom: 16px;
     box-shadow: 4px 4px 20px -10px;
     border: 1px solid #00000029;
 }

 .day__date {
     position: absolute;
     right: 10px;
     top: -4px;
     max-height: 100%;
     padding: 7px;
     background-color: #c67676;
     color: white;
     font-size: 2em;
     box-shadow: 0px 4px 7px -2px black;
 }

 form.filter input[type="radio"] {
     display: none;
 }

 .filter__option + label {
     padding: 3px 6px;
     display: inline-block;
 }

 .filter__option:checked + label {
     border-bottom: 3px solid #aeadad;
 }
</style>
<div id="dash">
    {% if user.is_authenticated %}
    <div id="penalties">
        <span class="header_like">Prikker:</span> {{ penalties__count }}
        {% if penalties__count %}
        {% if penalties__count >= 4 %}<span class="fa fa-times" style="color: #c64444"></span>{% endif %}
        <div class="penalties__questionmark">?</div>
        <div class="penalties__list">
            {% for penalty in penalties %}
            <div class="penalties__list__item">{{ penalty.event.headline }}, {{ penalty.event.event_start|date:"j. F Y" }} - {{ penalty.penalty }} prikk{% if penalty.penalty > 1 %}er{% endif %}</div>
            {% endfor %}
        </div>
        {% endif %} {# penalties__count #}
    </div>

    <div id="user_events">
        <span class="header_like">Påmeldte arrangementer:</span>
        {% for event in user_events %}
        <div class="user_events__item">
            <a href="{{ event.get_absolute_url }}">{{ event }}</a>
        </div>
        {% empty %}
        <div class="user_events__item user_events__item--empty"> Ikke påmeldt noen arrangementer</div>
        {% endfor %}
    </div>
    {% endif %} {# user authenticated #}

    <div id="event_list">
        <div>
            <form method="get" class="filter">
            {% for type in filter_form.type %}
                {{ type }}
            {% endfor %}

            {{ filter_form.start_time.label }}
            {{ filter_form.start_time }}
            {{ filter_form.start_time.errors }}
            <input type="submit" value="Filtrer">
            </form>
        </div>
        {% for event in object_list %}
        {% ifchanged %}<h2 class="month__name">{{ event.event_start|date:"F"|title }}</h2>{% endifchanged %}
        <div class="day">
            <span class="day__date">{{ event.event_start|date:"d." }}</span>
            <a href="{{ event.get_absolute_url }}">
                <div class="event_list__event">
                    <span class="header_like">
                        <div>{{ event.headline }}</div>
                        <div class="event_list__event__meta">
                            {{ event.event_start|date:"H:i" }}
                            <span class="fa fa-clock-o"></span>
                        </div>
                        {% if event.registration_required %}
                        <div class="event_list__event__meta">
                            {{ event.users_attending }} / {{ event.places }}
                            <span class="fa fa-user"></span>
                        </div>
                        {% endif %}
                        {% if event.company %}
                        <div class="event_list__event__meta">
                            {{ event.company }}
                        </div>
                        {% endif %}
                   </span>
                </div>
            </a>
        </div>
        {% endfor %}
    </div>
</div><!-- #dash -->
{% endblock %}
